<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="5079.999024968367" height="6905.248552828508"><desc>sequenceDiagram%0A%20%20%20%20actor%20User%0A%20%20%20%20participant%20Frontend%20as%20Frontend%20App%0A%20%20%20%20participant%20API%20as%20Express%20API%0A%20%20%20%20participant%20Controller%20as%20AuthController%0A%20%20%20%20participant%20Service%20as%20AuthService%0A%20%20%20%20participant%20EmailService%20as%20EmailService%0A%20%20%20%20participant%20Crypto%20as%20Crypto%20Module%0A%20%20%20%20participant%20Redis%20as%20Redis%20Cache%0A%20%20%20%20participant%20Prisma%20as%20Prisma%20ORM%0A%20%20%20%20participant%20DB%20as%20PostgreSQL%0A%0A%20%20%20%20rect%20rgb(200%2C%20220%2C%20250)%0A%20%20%20%20Note%20over%20User%2CDB%3A%20%C3%89TAPE%201%3A%20Demande%20de%20reset%0A%20%20%20%20User-%3E%3EFrontend%3A%20Click%20%22Mot%20de%20passe%20oubli%C3%A9%3F%22%0A%20%20%20%20Frontend-%3E%3EFrontend%3A%20Affiche%20formulaire%20email%0A%20%20%20%20User-%3E%3EFrontend%3A%20Saisit%20email%0A%20%20%20%20Frontend-%3E%3EAPI%3A%20POST%20%2Fapi%2Fauth%2Fforgot-password%0A%20%20%20%20Note%20over%20Frontend%2CAPI%3A%20Body%3A%20%7B%20email%3A%20%22user%40example.com%22%20%7D%0A%20%20%20%20%0A%20%20%20%20API-%3E%3EController%3A%20forgotPassword(req%2C%20res)%0A%20%20%20%20Controller-%3E%3EService%3A%20initiatePasswordReset(email)%0A%20%20%20%20%0A%20%20%20%20Service-%3E%3EPrisma%3A%20prisma.customer.findUnique(%7B%20where%3A%20%7B%20email%20%7D%20%7D)%0A%20%20%20%20Prisma-%3E%3EDB%3A%20SELECT%20*%20FROM%20customers%20WHERE%20email%20%3D%20%3F%0A%20%20%20%20%0A%20%20%20%20alt%20Email%20non%20trouv%C3%A9%0A%20%20%20%20%20%20%20%20DB--%3E%3EPrisma%3A%20null%0A%20%20%20%20%20%20%20%20Prisma--%3E%3EService%3A%20null%0A%20%20%20%20%20%20%20%20Note%20over%20Service%3A%20Pour%20la%20s%C3%A9curit%C3%A9%2C%20on%20ne%20r%C3%A9v%C3%A8le%20pas%20que%20l'email%20n'existe%20pas%0A%20%20%20%20%20%20%20%20Service--%3E%3EController%3A%20Success%20(fake)%0A%20%20%20%20%20%20%20%20Controller--%3E%3EFrontend%3A%20200%20OK%0A%20%20%20%20%20%20%20%20Frontend--%3E%3EUser%3A%20%22Email%20envoy%C3%A9%20si%20compte%20existe%22%0A%20%20%20%20else%20Email%20trouv%C3%A9%0A%20%20%20%20%20%20%20%20DB--%3E%3EPrisma%3A%20Customer%20data%0A%20%20%20%20%20%20%20%20Prisma--%3E%3EService%3A%20Customer%20object%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service-%3E%3ECrypto%3A%20randomBytes(32).toString('hex')%0A%20%20%20%20%20%20%20%20Crypto--%3E%3EService%3A%20resetToken%20(64%20chars)%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service-%3E%3ECrypto%3A%20createHash('sha256').update(resetToken)%0A%20%20%20%20%20%20%20%20Crypto--%3E%3EService%3A%20hashedToken%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service-%3E%3ERedis%3A%20SETEX%20reset%3AhashedToken%203600%20userId%0A%20%20%20%20%20%20%20%20Note%20over%20Redis%3A%20Token%20expire%20dans%201%20heure%0A%20%20%20%20%20%20%20%20Redis--%3E%3EService%3A%20OK%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service-%3E%3EPrisma%3A%20prisma.customer.update(%7B%20data%3A%20%7B%20reset_token_requested_at%3A%20NOW()%20%7D%20%7D)%0A%20%20%20%20%20%20%20%20Note%20over%20Service%2CPrisma%3A%20Log%20de%20la%20demande%20pour%20rate%20limiting%0A%20%20%20%20%20%20%20%20Prisma-%3E%3EDB%3A%20UPDATE%20customers%20SET%20reset_token_requested_at%20%3D%20NOW()%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service-%3E%3EEmailService%3A%20sendPasswordResetEmail(email%2C%20resetToken)%0A%20%20%20%20%20%20%20%20Note%20over%20EmailService%3A%20URL%3A%20https%3A%2F%2Fapp.com%2Freset-password%3Ftoken%3D%7BresetToken%7D%0A%20%20%20%20%20%20%20%20EmailService-%3E%3EEmailService%3A%20Envoie%20email%20via%20SendGrid%0A%20%20%20%20%20%20%20%20EmailService--%3E%3EService%3A%20Email%20sent%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service--%3E%3EController%3A%20Success%0A%20%20%20%20%20%20%20%20Controller--%3E%3EFrontend%3A%20200%20OK%0A%20%20%20%20%20%20%20%20Frontend--%3E%3EUser%3A%20%22Email%20envoy%C3%A9%20si%20compte%20existe%22%0A%20%20%20%20end%0A%20%20%20%20end%0A%0A%20%20%20%20rect%20rgb(250%2C%20220%2C%20200)%0A%20%20%20%20Note%20over%20User%2CDB%3A%20%C3%89TAPE%202%3A%20Click%20sur%20le%20lien%20email%0A%20%20%20%20User-%3E%3EUser%3A%20Ouvre%20email%0A%20%20%20%20User-%3E%3EFrontend%3A%20Click%20lien%20reset%0A%20%20%20%20Note%20over%20Frontend%3A%20URL%3A%20%2Freset-password%3Ftoken%3Dabc123...%0A%20%20%20%20%0A%20%20%20%20Frontend-%3E%3EAPI%3A%20GET%20%2Fapi%2Fauth%2Fverify-reset-token%3Ftoken%3Dabc123...%0A%20%20%20%20API-%3E%3EController%3A%20verifyResetToken(req%2C%20res)%0A%20%20%20%20Controller-%3E%3EService%3A%20validateResetToken(token)%0A%20%20%20%20%0A%20%20%20%20Service-%3E%3ECrypto%3A%20createHash('sha256').update(token)%0A%20%20%20%20Crypto--%3E%3EService%3A%20hashedToken%0A%20%20%20%20%0A%20%20%20%20Service-%3E%3ERedis%3A%20GET%20reset%3AhashedToken%0A%20%20%20%20%0A%20%20%20%20alt%20Token%20invalide%20ou%20expir%C3%A9%0A%20%20%20%20%20%20%20%20Redis--%3E%3EService%3A%20null%0A%20%20%20%20%20%20%20%20Service--%3E%3EController%3A%20InvalidTokenError%0A%20%20%20%20%20%20%20%20Controller--%3E%3EFrontend%3A%20400%20Bad%20Request%0A%20%20%20%20%20%20%20%20Frontend--%3E%3EUser%3A%20%22Lien%20invalide%20ou%20expir%C3%A9%22%0A%20%20%20%20else%20Token%20valide%0A%20%20%20%20%20%20%20%20Redis--%3E%3EService%3A%20userId%0A%20%20%20%20%20%20%20%20Service-%3E%3EPrisma%3A%20prisma.customer.findUnique(%7B%20where%3A%20%7B%20id%3A%20userId%20%7D%20%7D)%0A%20%20%20%20%20%20%20%20Prisma-%3E%3EDB%3A%20SELECT%20*%20FROM%20customers%20WHERE%20id%20%3D%20%3F%0A%20%20%20%20%20%20%20%20DB--%3E%3EPrisma%3A%20Customer%0A%20%20%20%20%20%20%20%20Prisma--%3E%3EService%3A%20Customer%20object%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service--%3E%3EController%3A%20Token%20valid%0A%20%20%20%20%20%20%20%20Controller--%3E%3EFrontend%3A%20200%20OK%0A%20%20%20%20%20%20%20%20Frontend--%3E%3EUser%3A%20Affiche%20formulaire%20nouveau%20mot%20de%20passe%0A%20%20%20%20end%0A%20%20%20%20end%0A%0A%20%20%20%20rect%20rgb(220%2C%20250%2C%20220)%0A%20%20%20%20Note%20over%20User%2CDB%3A%20%C3%89TAPE%203%3A%20D%C3%A9finir%20nouveau%20mot%20de%20passe%0A%20%20%20%20User-%3E%3EFrontend%3A%20Saisit%20nouveau%20mot%20de%20passe%0A%20%20%20%20Frontend-%3E%3EAPI%3A%20POST%20%2Fapi%2Fauth%2Freset-password%0A%20%20%20%20Note%20over%20Frontend%2CAPI%3A%20Body%3A%20%7B%20token%2C%20password%2C%20confirmPassword%20%7D%0A%20%20%20%20%0A%20%20%20%20API-%3E%3EController%3A%20resetPassword(req%2C%20res)%0A%20%20%20%20Controller-%3E%3EService%3A%20resetPassword(token%2C%20newPassword)%0A%20%20%20%20%0A%20%20%20%20Service-%3E%3EService%3A%20validatePassword(newPassword)%0A%20%20%20%20Note%20over%20Service%3A%20Min%208%20chars%2C%20majuscule%2C%20chiffre%2C%20symbole%0A%20%20%20%20%0A%20%20%20%20alt%20Mot%20de%20passe%20faible%0A%20%20%20%20%20%20%20%20Service--%3E%3EController%3A%20WeakPasswordError%0A%20%20%20%20%20%20%20%20Controller--%3E%3EFrontend%3A%20400%20Bad%20Request%0A%20%20%20%20%20%20%20%20Frontend--%3E%3EUser%3A%20%22Mot%20de%20passe%20trop%20faible%22%0A%20%20%20%20else%20Mot%20de%20passe%20OK%0A%20%20%20%20%20%20%20%20Service-%3E%3ECrypto%3A%20createHash('sha256').update(token)%0A%20%20%20%20%20%20%20%20Crypto--%3E%3EService%3A%20hashedToken%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20Service-%3E%3ERedis%3A%20GET%20reset%3AhashedToken%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20alt%20Token%20invalide%0A%20%20%20%20%20%20%20%20%20%20%20%20Redis--%3E%3EService%3A%20null%0A%20%20%20%20%20%20%20%20%20%20%20%20Service--%3E%3EController%3A%20InvalidTokenError%0A%20%20%20%20%20%20%20%20%20%20%20%20Controller--%3E%3EFrontend%3A%20400%20Bad%20Request%0A%20%20%20%20%20%20%20%20else%20Token%20valide%0A%20%20%20%20%20%20%20%20%20%20%20%20Redis--%3E%3EService%3A%20userId%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Service-%3E%3EService%3A%20bcrypt.hash(newPassword%2C%2010)%0A%20%20%20%20%20%20%20%20%20%20%20%20Service--%3E%3EService%3A%20hashedPassword%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Service-%3E%3EPrisma%3A%20prisma.%24transaction(%5B...%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20Note%20over%20Prisma%2CDB%3A%20Transaction%20START%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Prisma-%3E%3EDB%3A%20UPDATE%20customers%20SET%20password%20%3D%20%3F%2C%20reset_token_requested_at%20%3D%20NULL%0A%20%20%20%20%20%20%20%20%20%20%20%20Prisma-%3E%3EDB%3A%20INSERT%20INTO%20password_history%20(customer_id%2C%20changed_at)%0A%20%20%20%20%20%20%20%20%20%20%20%20Note%20over%20DB%3A%20Log%20pour%20audit%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Note%20over%20Prisma%2CDB%3A%20Transaction%20COMMIT%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Service-%3E%3ERedis%3A%20DEL%20reset%3AhashedToken%0A%20%20%20%20%20%20%20%20%20%20%20%20Note%20over%20Redis%3A%20Invalider%20le%20token%20imm%C3%A9diatement%0A%20%20%20%20%20%20%20%20%20%20%20%20Redis--%3E%3EService%3A%20OK%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Service-%3E%3EEmailService%3A%20sendPasswordChangedConfirmation(email)%0A%20%20%20%20%20%20%20%20%20%20%20%20Note%20over%20EmailService%3A%20Email%20de%20s%C3%A9curit%C3%A9%0A%20%20%20%20%20%20%20%20%20%20%20%20EmailService--%3E%3EService%3A%20Email%20sent%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20Service--%3E%3EController%3A%20Password%20reset%20successful%0A%20%20%20%20%20%20%20%20%20%20%20%20Controller--%3E%3EFrontend%3A%20200%20OK%0A%20%20%20%20%20%20%20%20%20%20%20%20Frontend--%3E%3EUser%3A%20%22Mot%20de%20passe%20modifi%C3%A9%20avec%20succ%C3%A8s%22%0A%20%20%20%20%20%20%20%20%20%20%20%20Frontend-%3E%3EFrontend%3A%20Redirect%20to%20%2Flogin%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0A%20%20%20%20end</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="5079" height="6905"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.13199855000002 142.09742039850002 L 145.13199855000002 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 304.7183714604024 142.09742039850002 L 304.7183714604024 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 537.8946818646875 142.09742039850002 L 537.8946818646875 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 775.9457023519806 142.09742039850002 L 775.9457023519806 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1025.8148914794103 142.09742039850002 L 1025.8148914794103 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1282.5953049720745 142.09742039850002 L 1282.5953049720745 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1544.6692212723558 142.09742039850002 L 1544.6692212723558 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1781.9078104241996 142.09742039850002 L 1781.9078104241996 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2014.640318948602 142.09742039850002 L 2014.640318948602 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2236.778703632672 142.09742039850002 L 2236.778703632672 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 142.09742039850002 L 2411.690907286469 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2802.716353634516 142.09742039850002 L 2802.716353634516 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 142.09742039850002 L 3044.987374933735 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 142.09742039850002 L 3357.3442726977974 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 142.09742039850002 L 3890.560102956977 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4447.9277123909615 142.09742039850002 L 4447.9277123909615 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4563.348163420246 142.09742039850002 L 4563.348163420246 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4687.326231637031 142.09742039850002 L 4687.326231637031 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4832.485383533015 142.09742039850002 L 4832.485383533015 6905.248552828508" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="20.298181615384618,8.795878700000001"/></g><g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 160.17295112700003 30.477719695500014 A 15.040952577 15.040952577 0 1 1 160.17294360652437 30.46267874542983" stroke-miterlimit="10" stroke-width="4.485898137" stroke-dasharray=""/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.13199855000002 45.51867227250001 L 145.13199855000002 77.7115883145 M 126.13290055800002 57.12923215650002 L 164.13109654200002 57.12923215650002 M 145.13199855000002 77.7115883145 L 126.13290055800002 107.79349346850002 M 145.13199855000002 77.7115883145 L 164.13109654200002 107.79349346850002" stroke-miterlimit="10" stroke-width="4.485898137"/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="129.65598536640627" y="134.1811295685" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 190.51873264200006 70.85080292850002 L 418.9180102788048 70.85080292850002 L 418.9180102788048 142.09742039850002 L 190.51873264200006 142.09742039850002 L 190.51873264200006 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="219.14931781050007" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Frontend as Frontend App</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 445.3056463788047 70.85080292850002 L 630.4837173505703 70.85080292850002 L 630.4837173505703 142.09742039850002 L 445.3056463788047 142.09742039850002 L 445.3056463788047 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="473.9362315473047" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">API as Express API</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 656.8713534505704 70.85080292850002 L 895.0200512533906 70.85080292850002 L 895.0200512533906 142.09742039850002 L 656.8713534505704 142.09742039850002 L 656.8713534505704 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="685.5019386190704" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Controller as AuthController</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 921.4076873533908 70.85080292850002 L 1130.2220956054298 70.85080292850002 L 1130.2220956054298 142.09742039850002 L 921.4076873533908 142.09742039850002 L 921.4076873533908 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="950.0382725218908" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Service as AuthService</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1156.60973170543 70.85080292850002 L 1408.5808782387192 70.85080292850002 L 1408.5808782387192 142.09742039850002 L 1156.60973170543 142.09742039850002 L 1156.60973170543 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1185.24031687393" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">EmailService as EmailService</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1434.9685143387192 70.85080292850002 L 1654.3699282059927 70.85080292850002 L 1654.3699282059927 142.09742039850002 L 1434.9685143387192 142.09742039850002 L 1434.9685143387192 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1463.599099507219" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Crypto as Crypto Module</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1680.7575643059927 70.85080292850002 L 1883.0580565424068 70.85080292850002 L 1883.0580565424068 142.09742039850002 L 1680.7575643059927 142.09742039850002 L 1680.7575643059927 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1709.3881494744926" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Redis as Redis Cache</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1909.4456926424068 70.85080292850002 L 2119.8349452547973 70.85080292850002 L 2119.8349452547973 142.09742039850002 L 1909.4456926424068 142.09742039850002 L 1909.4456926424068 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1938.0762778109067" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Prisma as Prisma ORM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 2146.222581354797 70.85080292850002 L 2327.334825910547 70.85080292850002 L 2327.334825910547 142.09742039850002 L 2146.222581354797 142.09742039850002 L 2146.222581354797 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2174.853166523297" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DB as PostgreSQL</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 2353.722462010547 70.85080292850002 L 2469.6593525623907 70.85080292850002 L 2469.6593525623907 142.09742039850002 L 2353.722462010547 142.09742039850002 L 2353.722462010547 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2382.3530471790473" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Frontend</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 2762.27117038252 70.85080292850002 L 2843.161536886512 70.85080292850002 L 2843.161536886512 142.09742039850002 L 2762.27117038252 142.09742039850002 L 2762.27117038252 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2790.90175555102" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">API</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 2984.581574616309 70.85080292850002 L 3105.3931752511603 70.85080292850002 L 3105.3931752511603 142.09742039850002 L 2984.581574616309 142.09742039850002 L 2984.581574616309 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3013.212159784809" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Controller</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 3304.2720447680667 70.85080292850002 L 3410.4165006275275 70.85080292850002 L 3410.4165006275275 142.09742039850002 L 3304.2720447680667 142.09742039850002 L 3304.2720447680667 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3332.902629936567" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Service</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 3839.1235180326175 70.85080292850002 L 3941.996687881336 70.85080292850002 L 3941.996687881336 142.09742039850002 L 3839.1235180326175 142.09742039850002 L 3839.1235180326175 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3867.7541032011177" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Prisma</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 4409.114593958301 70.85080292850002 L 4486.740830823622 70.85080292850002 L 4486.740830823622 142.09742039850002 L 4409.114593958301 142.09742039850002 L 4409.114593958301 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4437.745179126801" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DB</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 4513.128466923621 70.85080292850002 L 4613.567859916871 70.85080292850002 L 4613.567859916871 142.09742039850002 L 4513.128466923621 142.09742039850002 L 4513.128466923621 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4541.759052092121" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Crypto</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 4639.955496016871 70.85080292850002 L 4734.696967257191 70.85080292850002 L 4734.696967257191 142.09742039850002 L 4639.955496016871 142.09742039850002 L 4639.955496016871 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4668.586081185371" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Redis</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 4761.084603357191 70.85080292850002 L 4903.886163708839 70.85080292850002 L 4903.886163708839 142.09742039850002 L 4761.084603357191 142.09742039850002 L 4761.084603357191 70.85080292850002 Z" stroke-miterlimit="10" stroke-width="4.222021776" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4789.715188525691" y="115.70978429850003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">EmailService</text></g></g><g><g><rect fill="white" stroke="none" x="1181.650908821594" y="194.8726925985" width="193.52108819328126" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1185.609054236594" y="218.6215650885" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Click "Mot de passe oublié?"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.13199855000002 229.17661952850003 L 2408.392452773969 229.17661952850003" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2411.690907286469,229.17661952850003) translate(-2411.690907286469,-229.17661952850003)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2389.0832048215357 219.09113128249294 L 2409.2188844267353 229.17661952850003 L 2389.0832048215357 239.26210777450711" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2442.916276671469" y="268.75807367850007" width="160.82244927726563" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2446.874422086469" y="292.50694616850006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Affiche formulaire email</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 303.06200060850006 L 2517.241451686469 303.06200060850006 L 2517.241451686469 337.36592753850005 L 2414.989361798969 337.36592753850005" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2411.690907286469,337.36592753850005) translate(-2411.690907286469,-337.36592753850005)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 327.28043929249293 L 2414.162930146203 337.36592753850005 L 2434.2986097514026 347.45141578450716" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1236.976592415344" y="376.94738168850006" width="82.86972100578124" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1240.934737830344" y="400.69625417850006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Saisit email</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.13199855000002 411.25130861850005 L 2408.392452773969 411.25130861850005" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2411.690907286469,411.25130861850005) translate(-2411.690907286469,-411.25130861850005)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2389.0832048215357 401.16582037249293 L 2409.2188844267353 411.25130861850005 L 2389.0832048215357 421.33679686450716" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2498.5390031118986" y="450.83276276850006" width="217.3292546971875" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2502.497148526899" y="474.58163525850006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /api/auth/forgot-password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 485.13668969850005 L 2799.417899122016 485.13668969850005" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2802.716353634516,485.13668969850005) translate(-2802.716353634516,-485.13668969850005)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2780.1086511695826 475.05120145249293 L 2800.244330774782 485.13668969850005 L 2780.1086511695826 495.22217794450717" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2839.235210568344" y="524.7181438485001" width="169.2333074315625" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2843.193355983344" y="548.4670163385001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">forgotPassword(req, res)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2802.716353634516 559.0220707785 L 3041.688920421235 559.0220707785" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3044.987374933735,559.0220707785) translate(-3044.987374933735,-559.0220707785)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3022.3796724688013 548.936582532493 L 3042.515352074001 559.0220707785 L 3022.3796724688013 569.107559024507" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3102.2900453441252" y="598.6035249285001" width="197.75155694328126" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3106.2481907591255" y="622.3523974185001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">initiatePasswordReset(email)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 632.9074518585 L 3354.0458181852973 632.9074518585" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3357.3442726977974,632.9074518585) translate(-3357.3442726977974,-632.9074518585)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3334.736570232864 622.821963612493 L 3354.8722498380635 632.9074518585 L 3334.736570232864 642.992940104507" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3464.768616692172" y="672.4889060085001" width="318.36715752921873" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3468.7267621071724" y="696.2377784985001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">prisma.customer.findUnique({ where: { email } })</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 706.7928329385 L 3887.261648444477 706.7928329385" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3890.560102956977,706.7928329385) translate(-3890.560102956977,-706.7928329385)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3867.9524004920436 696.707344692493 L 3888.088080097243 706.7928329385 L 3867.9524004920436 716.8783211845071" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4011.119716116391" y="746.3742870885001" width="316.24838311515623" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4015.077861531391" y="770.1231595785001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SELECT * FROM customers WHERE email = ?</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 780.6782140185001 L 4444.629257878461 780.6782140185001" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4447.9277123909615,780.6782140185001) translate(-4447.9277123909615,-780.6782140185001)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4425.320009926028 770.592725772493 L 4445.455689531228 780.6782140185001 L 4425.320009926028 790.7637022645071" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4153.875606008969" y="891.5062856385001" width="30.73660333" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4157.833751423969" y="915.2551581285002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">null</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4447.9277123909615 925.8102125685001 L 3893.858557469477 925.8102125685001" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3890.560102956977,925.8102125685001) translate(-3890.560102956977,-925.8102125685001)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3913.1678054219105 915.7247243224931 L 3893.032125816711 925.8102125685001 L 3913.1678054219105 935.8957008145071" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3608.583886162387" y="965.3916667185001" width="30.73660333" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3612.542031577387" y="989.1405392085002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">null</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 999.6955936485001 L 3360.6427272102974 999.6955936485001" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,999.6955936485001) translate(-3357.3442726977974,-999.6955936485001)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 989.6101054024931 L 3359.8162955575312 999.6955936485001 L 3379.951975162731 1009.7810818945071" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3148.7324052684417" y="1039.2770477985002" width="104.86683709464843" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3152.690550683442" y="1063.0259202885002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Success (fake)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 1073.5809747285002 L 3048.285829446235 1073.5809747285002" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3044.987374933735,1073.5809747285002) translate(-3044.987374933735,-1073.5809747285002)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3067.5950773986683 1063.495486482493 L 3047.4593977934687 1073.5809747285002 L 3067.5950773986683 1083.6664629745073" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2699.5241612834807" y="1113.1624288785004" width="57.62995965324219" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2703.482306698481" y="1136.9113013685003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 1147.4663558085003 L 2414.989361798969 1147.4663558085003" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(2411.690907286469,1147.4663558085003) translate(-2411.690907286469,-1147.4663558085003)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 1137.3808675624932 L 2414.162930146203 1147.4663558085003 L 2434.2986097514026 1157.5518440545075" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1170.6595071492306" y="1187.0478099585005" width="215.50389153800782" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1174.6176525642306" y="1210.7966824485004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"Email envoyé si compte existe"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 1221.3517368885005 L 148.43045306250002 1221.3517368885005" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(145.13199855000002,1221.3517368885005) translate(-145.13199855000002,-1221.3517368885005)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 167.73970101493347 1211.2662486424933 L 147.6040214097338 1221.3517368885005 L 167.73970101493347 1231.4372251345076" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4117.211329885922" y="1332.1798085085004" width="104.06515557609374" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4121.169475300922" y="1355.9286809985003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Customer data</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4447.9277123909615 1366.4837354385004 L 3893.858557469477 1366.4837354385004" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3890.560102956977,1366.4837354385004) translate(-3890.560102956977,-1366.4837354385004)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3913.1678054219105 1356.3982471924933 L 3893.032125816711 1366.4837354385004 L 3913.1678054219105 1376.5692236845075" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3566.6261301199065" y="1406.0651895885005" width="114.65211541496093" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3570.5842755349067" y="1429.8140620785005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Customer object</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 1440.3691165185005 L 3360.6427272102974 1440.3691165185005" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,1440.3691165185005) translate(-3357.3442726977974,-1440.3691165185005)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 1430.2836282724934 L 3359.8162955575312 1440.3691165185005 L 3379.951975162731 1450.4546047645076" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3853.370959912088" y="1479.9505706685006" width="213.9505162938672" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3857.329105327088" y="1503.6994431585006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">randomBytes(32).toString('hex')</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 1514.2544975985006 L 4560.049708907746 1514.2544975985006" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4563.348163420246,1514.2544975985006) translate(-4563.348163420246,-1514.2544975985006)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4540.740460955313 1504.1690093524935 L 4560.876140560513 1514.2544975985006 L 4540.740460955313 1524.3399858445077" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3885.5004917724395" y="1553.8359517485007" width="149.69145257316407" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3889.4586371874398" y="1577.5848242385007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">resetToken (64 chars)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4563.348163420246 1588.1398786785007 L 3360.6427272102974 1588.1398786785007" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,1588.1398786785007) translate(-3357.3442726977974,-1588.1398786785007)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 1578.0543904324936 L 3359.8162955575312 1588.1398786785007 L 3379.951975162731 1598.2253669245079" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3821.9822804076935" y="1627.7213328285009" width="276.72787530265623" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3825.9404258226937" y="1651.4702053185008" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">createHash('sha256').update(resetToken)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 1662.0252597585009 L 4560.049708907746 1662.0252597585009" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4563.348163420246,1662.0252597585009) translate(-4563.348163420246,-1662.0252597585009)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4540.740460955313 1651.9397715124937 L 4560.876140560513 1662.0252597585009 L 4540.740460955313 1672.110748004508" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3912.780353222635" y="1701.606713908501" width="95.13172967277343" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3916.738498637635" y="1725.355586398501" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">hashedToken</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4563.348163420246 1735.910640838501 L 3360.6427272102974 1735.910640838501" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,1735.910640838501) translate(-3357.3442726977974,-1735.910640838501)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 1725.8251525924939 L 3359.8162955575312 1735.910640838501 L 3379.951975162731 1745.996129084508" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3889.615517702121" y="1775.492094988501" width="265.439484189375" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3893.573663117121" y="1799.240967478501" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SETEX reset:hashedToken 3600 userId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 1809.796021918501 L 4684.027777124531 1809.796021918501" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4687.326231637031,1809.796021918501) translate(-4687.326231637031,-1809.796021918501)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4664.718529172098 1799.710533672494 L 4684.854208777298 1809.796021918501 L 4664.718529172098 1819.8815101645082" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4007.7865534687226" y="1849.3774760685012" width="29.097397397382814" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4011.744698883723" y="1873.1263485585011" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4687.326231637031 1883.6814029985012 L 3360.6427272102974 1883.6814029985012" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,1883.6814029985012) translate(-3357.3442726977974,-1883.6814029985012)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 1873.595914752494 L 3359.8162955575312 1883.6814029985012 L 3379.951975162731 1893.7668912445083" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3388.569642082797" y="1923.2628571485013" width="470.76510674796873" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3392.5277874977974" y="1947.0117296385013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">prisma.customer.update({ data: { reset_token_requested_at: NOW() } })</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 1957.5667840785013 L 3887.261648444477 1957.5667840785013" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3890.560102956977,1957.5667840785013) translate(-3890.560102956977,-1957.5667840785013)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3867.9524004920436 1947.4812958324942 L 3888.088080097243 1957.5667840785013 L 3867.9524004920436 1967.6522723245084" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3965.6043581451995" y="1997.1482382285014" width="407.2791143163281" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3969.5625035601997" y="2020.8971107185014" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UPDATE customers SET reset_token_requested_at = NOW()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 2031.4521651585014 L 4444.629257878461 2031.4521651585014" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4447.9277123909615,2031.4521651585014) translate(-4447.9277123909615,-2031.4521651585014)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4425.320009926028 2021.3666769124943 L 4445.455689531228 2031.4521651585014 L 4425.320009926028 2041.5376534045085" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3943.0755715553864" y="2071.0336193085013" width="303.67849786125" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3947.0337169703866" y="2094.7824917985013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sendPasswordResetEmail(email, resetToken)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 2105.3375462385015 L 4829.186929020515 2105.3375462385015" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4832.485383533015,2105.3375462385015) translate(-4832.485383533015,-2105.3375462385015)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4809.877681068082 2095.2520579924944 L 4830.013360673282 2105.3375462385015 L 4809.877681068082 2115.4230344845087" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4863.710752918015" y="2144.9190003885014" width="180.66496331535157" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4867.668898333015" y="2168.6678728785014" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Envoie email via SendGrid</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4832.485383533015 2179.222927318501 L 4938.035927933015 2179.222927318501 L 4938.035927933015 2213.5268542485014 L 4835.783838045515 2213.5268542485014" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4832.485383533015,2213.5268542485014) translate(-4832.485383533015,-2213.5268542485014)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4855.093085997948 2203.4413660024943 L 4834.957406392748 2213.5268542485014 L 4855.093085997948 2223.6123424945085" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4056.736940879117" y="2253.1083083985013" width="76.35577447257812" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4060.695086294117" y="2276.8571808885013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Email sent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4832.485383533015 2287.4122353285015 L 3360.6427272102974 2287.4122353285015" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,2287.4122353285015) translate(-3357.3442726977974,-2287.4122353285015)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 2277.3267470824944 L 3359.8162955575312 2287.4122353285015 L 3379.951975162731 2297.4977235745087" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3169.505476557504" y="2326.9936894785014" width="63.32069451652344" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3173.4636219725044" y="2350.7425619685014" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Success</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 2361.2976164085017 L 3048.285829446235 2361.2976164085017" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3044.987374933735,2361.2976164085017) translate(-3044.987374933735,-2361.2976164085017)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3067.5950773986683 2351.2121281624945 L 3047.4593977934687 2361.2976164085017 L 3067.5950773986683 2371.3831046545088" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2699.5241612834807" y="2400.8790705585016" width="57.62995965324219" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2703.482306698481" y="2424.6279430485015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 2435.1829974885018 L 2414.989361798969 2435.1829974885018" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(2411.690907286469,2435.1829974885018) translate(-2411.690907286469,-2435.1829974885018)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 2425.0975092424947 L 2414.162930146203 2435.1829974885018 L 2434.2986097514026 2445.268485734509" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1170.6595071492306" y="2474.7644516385017" width="215.50389153800782" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1174.6176525642306" y="2498.5133241285016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"Email envoyé si compte existe"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 2509.068378568502 L 148.43045306250002 2509.068378568502" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(145.13199855000002,2509.068378568502) translate(-145.13199855000002,-2509.068378568502)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 167.73970101493347 2498.9828903224948 L 147.6040214097338 2509.068378568502 L 167.73970101493347 2519.153866814509" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="176.35736793500004" y="2588.2312868685017" width="86.94274957023437" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="180.31551335000003" y="2611.9801593585016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Ouvre email</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.13199855000002 2622.5352137985014 L 250.68254295000003 2622.5352137985014 L 250.68254295000003 2656.8391407285017 L 148.43045306250002 2656.8391407285017" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(145.13199855000002,2656.8391407285017) translate(-145.13199855000002,-2656.8391407285017)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 167.73970101493347 2646.7536524824945 L 147.6040214097338 2656.8391407285017 L 167.73970101493347 2666.924628974509" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1226.7940667805783" y="2696.4205948785016" width="103.2347722753125" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1230.7522121955783" y="2720.1694673685015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Click lien reset</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.13199855000002 2730.724521808502 L 2408.392452773969 2730.724521808502" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2411.690907286469,2730.724521808502) translate(-2411.690907286469,-2730.724521808502)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2389.0832048215357 2720.6390335624947 L 2409.2188844267353 2730.724521808502 L 2389.0832048215357 2740.810010054509" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2442.916276671469" y="2770.3059759585017" width="328.574738095625" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2446.874422086469" y="2794.0548484485016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /api/auth/verify-reset-token?token=abc123...</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 2804.609902888502 L 2799.417899122016 2804.609902888502" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2802.716353634516,2804.609902888502) translate(-2802.716353634516,-2804.609902888502)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2780.1086511695826 2794.524414642495 L 2800.244330774782 2804.609902888502 L 2780.1086511695826 2814.695391134509" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2833.941723019516" y="2844.191357038502" width="179.82028252921876" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2837.899868434516" y="2867.9402295285017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">verifyResetToken(req, res)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2802.716353634516 2878.495283968502 L 3041.688920421235 2878.495283968502" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3044.987374933735,2878.495283968502) translate(-3044.987374933735,-2878.495283968502)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3022.3796724688013 2868.409795722495 L 3042.515352074001 2878.495283968502 L 3022.3796724688013 2888.580772214509" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3110.4217439525237" y="2918.076738118502" width="181.48815972648438" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3114.379889367524" y="2941.825610608502" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validateResetToken(token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 2952.380665048502 L 3354.0458181852973 2952.380665048502" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3357.3442726977974,2952.380665048502) translate(-3357.3442726977974,-2952.380665048502)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3334.736570232864 2942.295176802495 L 3354.8722498380635 2952.380665048502 L 3334.736570232864 2962.4661532945092" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3839.906390820291" y="2991.962119198502" width="240.87965447746095" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3843.8645362352913" y="3015.710991688502" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">createHash('sha256').update(token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 3026.2660461285022 L 4560.049708907746 3026.2660461285022" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4563.348163420246,3026.2660461285022) translate(-4563.348163420246,-3026.2660461285022)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4540.740460955313 3016.180557882495 L 4560.876140560513 3026.2660461285022 L 4540.740460955313 3036.3515343745094" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3912.780353222635" y="3065.847500278502" width="95.13172967277343" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3916.738498637635" y="3089.596372768502" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">hashedToken</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4563.348163420246 3100.1514272085024 L 3360.6427272102974 3100.1514272085024" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,3100.1514272085024) translate(-3357.3442726977974,-3100.1514272085024)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 3090.0659389624952 L 3359.8162955575312 3100.1514272085024 L 3379.951975162731 3110.2369154545095" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3939.3327418232147" y="3139.7328813585023" width="166.00502068839845" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3943.290887238215" y="3163.481753848502" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET reset:hashedToken</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 3174.0368082885025 L 4684.027777124531 3174.0368082885025" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4687.326231637031,3174.0368082885025) translate(-4687.326231637031,-3174.0368082885025)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4664.718529172098 3163.9513200424954 L 4684.854208777298 3174.0368082885025 L 4664.718529172098 3184.1222965345096" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4006.966950502414" y="3284.864879908502" width="30.73660333" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4010.925095917414" y="3308.613752398502" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">null</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4687.326231637031 3319.1688068385024 L 3360.6427272102974 3319.1688068385024" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,3319.1688068385024) translate(-3357.3442726977974,-3319.1688068385024)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 3309.0833185924953 L 3359.8162955575312 3319.1688068385024 L 3379.951975162731 3329.2542950845095" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3140.171202265512" y="3358.7502609885023" width="121.9892431005078" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3144.129347680512" y="3382.4991334785022" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">InvalidTokenError</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 3393.0541879185025 L 3048.285829446235 3393.0541879185025" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3044.987374933735,3393.0541879185025) translate(-3044.987374933735,-3393.0541879185025)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3067.5950773986683 3382.9686996724954 L 3047.4593977934687 3393.0541879185025 L 3067.5950773986683 3403.1396761645096" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2667.7346257610197" y="3432.6356420685024" width="121.20903069816406" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2671.69277117602" y="3456.3845145585024" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">400 Bad Request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 3466.9395689985026 L 2414.989361798969 3466.9395689985026" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(2411.690907286469,3466.9395689985026) translate(-2411.690907286469,-3466.9395689985026)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 3456.8540807524955 L 2414.162930146203 3466.9395689985026 L 2434.2986097514026 3477.0250572445098" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1196.307319038879" y="3506.5210231485025" width="164.20826775871095" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1200.265464453879" y="3530.2698956385025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"Lien invalide ou expiré"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 3540.8249500785028 L 148.43045306250002 3540.8249500785028" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(145.13199855000002,3540.8249500785028) translate(-145.13199855000002,-3540.8249500785028)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 167.73970101493347 3530.7394618324956 L 147.6040214097338 3540.8249500785028 L 167.73970101493347 3550.91043832451" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3998.004891481418" y="3651.6530216985025" width="48.66072137199219" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4001.963036896418" y="3675.4018941885024" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">userId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4687.326231637031 3685.9569486285027 L 3360.6427272102974 3685.9569486285027" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,3685.9569486285027) translate(-3357.3442726977974,-3685.9569486285027)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 3675.8714603824956 L 3359.8162955575312 3685.9569486285027 L 3379.951975162731 3696.04243687451" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3452.134408012973" y="3725.5384027785026" width="343.63552911125" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3456.092553427973" y="3749.2872752685025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">prisma.customer.findUnique({ where: { id: userId } })</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 3759.842329708503 L 3887.261648444477 3759.842329708503" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3890.560102956977,3759.842329708503) translate(-3890.560102956977,-3759.842329708503)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3867.9524004920436 3749.7568414624957 L 3888.088080097243 3759.842329708503 L 3867.9524004920436 3769.92781795451" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4022.930736013852" y="3799.4237838585027" width="292.6263738378125" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4026.888881428852" y="3823.1726563485026" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SELECT * FROM customers WHERE id = ?</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 3833.727710788503 L 4444.629257878461 3833.727710788503" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4447.9277123909615,3833.727710788503) translate(-4447.9277123909615,-3833.727710788503)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4425.320009926028 3823.642222542496 L 4445.455689531228 3833.727710788503 L 4425.320009926028 3843.81319903451" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4133.514117666684" y="3873.309164938503" width="71.4595800145703" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4137.472263081684" y="3897.0580374285028" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Customer</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4447.9277123909615 3907.613091868503 L 3893.858557469477 3907.613091868503" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3890.560102956977,3907.613091868503) translate(-3890.560102956977,-3907.613091868503)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3913.1678054219105 3897.527603622496 L 3893.032125816711 3907.613091868503 L 3913.1678054219105 3917.69858011451" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3566.6261301199065" y="3947.194546018503" width="114.65211541496093" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3570.5842755349067" y="3970.943418508503" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Customer object</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 3981.498472948503 L 3360.6427272102974 3981.498472948503" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,3981.498472948503) translate(-3357.3442726977974,-3981.498472948503)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 3971.412984702496 L 3359.8162955575312 3981.498472948503 L 3379.951975162731 3991.5839611945103" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3160.536253535043" y="4021.079927098503" width="81.2591405614453" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3164.4943989500434" y="4044.828799588503" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Token valid</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 4055.3838540285033 L 3048.285829446235 4055.3838540285033" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3044.987374933735,4055.3838540285033) translate(-3044.987374933735,-4055.3838540285033)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3067.5950773986683 4045.298365782496 L 3047.4593977934687 4055.3838540285033 L 3067.5950773986683 4065.4693422745104" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2699.5241612834807" y="4094.965308178503" width="57.62995965324219" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2703.482306698481" y="4118.714180668503" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 4129.269235108503 L 2414.989361798969 4129.269235108503" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(2411.690907286469,4129.269235108503) translate(-2411.690907286469,-4129.269235108503)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 4119.183746862496 L 2414.162930146203 4129.269235108503 L 2434.2986097514026 4139.3547233545105" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1141.3502801594846" y="4168.850689258504" width="274.1223455175" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1145.3084255744845" y="4192.599561748504" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Affiche formulaire nouveau mot de passe</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 4203.1546161885035 L 148.43045306250002 4203.1546161885035" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(145.13199855000002,4203.1546161885035) translate(-145.13199855000002,-4203.1546161885035)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 167.73970101493347 4193.069127942496 L 147.6040214097338 4203.1546161885035 L 167.73970101493347 4213.240104434511" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1180.3266442952267" y="4282.317524488504" width="196.16961724601563" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.2847897102267" y="4306.066396978505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Saisit nouveau mot de passe</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 145.13199855000002 4316.621451418504 L 2408.392452773969 4316.621451418504" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2411.690907286469,4316.621451418504) translate(-2411.690907286469,-4316.621451418504)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2389.0832048215357 4306.535963172497 L 2409.2188844267353 4316.621451418504 L 2389.0832048215357 4326.706939664511" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2500.987107970297" y="4356.202905568504" width="212.43304498039063" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2504.9452533852973" y="4379.951778058505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /api/auth/reset-password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 4390.506832498504 L 2799.417899122016 4390.506832498504" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2802.716353634516,4390.506832498504) translate(-2802.716353634516,-4390.506832498504)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2780.1086511695826 4380.421344252497 L 2800.244330774782 4390.506832498504 L 2780.1086511695826 4400.592320744511" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2841.6833154267424" y="4430.088286648504" width="164.33709771476563" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2845.6414608417426" y="4453.837159138505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">resetPassword(req, res)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2802.716353634516 4464.392213578504 L 3041.688920421235 4464.392213578504" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3044.987374933735,4464.392213578504) translate(-3044.987374933735,-4464.392213578504)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3022.3796724688013 4454.306725332497 L 3042.515352074001 4464.392213578504 L 3022.3796724688013 4474.477701824511" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3076.2127443187346" y="4503.973667728505" width="249.9061589940625" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3080.170889733735" y="4527.722540218505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">resetPassword(token, newPassword)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 4538.277594658504 L 3354.0458181852973 4538.277594658504" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3357.3442726977974,4538.277594658504) translate(-3357.3442726977974,-4538.277594658504)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3334.736570232864 4528.192106412497 L 3354.8722498380635 4538.277594658504 L 3334.736570232864 4548.363082904511" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3388.569642082797" y="4577.859048808504" width="223.8360143407422" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3392.5277874977974" y="4601.607921298504" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validatePassword(newPassword)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 4612.162975738504 L 3462.8948170977974 4612.162975738504 L 3462.8948170977974 4646.466902668504 L 3360.6427272102974 4646.466902668504" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3357.3442726977974,4646.466902668504) translate(-3357.3442726977974,-4646.466902668504)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 4636.381414422497 L 3359.8162955575312 4646.466902668504 L 3379.951975162731 4656.552390914511" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3130.1318345897307" y="4757.294974288505" width="142.06797845207032" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3134.089980004731" y="4781.043846778505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">WeakPasswordError</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 4791.598901218505 L 3048.285829446235 4791.598901218505" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3044.987374933735,4791.598901218505) translate(-3044.987374933735,-4791.598901218505)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3067.5950773986683 4781.5134129724975 L 3047.4593977934687 4791.598901218505 L 3067.5950773986683 4801.684389464512" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2667.7346257610197" y="4831.180355368505" width="121.20903069816406" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2671.69277117602" y="4854.929227858505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">400 Bad Request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 4865.484282298505 L 2414.989361798969 4865.484282298505" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(2411.690907286469,4865.484282298505) translate(-2411.690907286469,-4865.484282298505)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 4855.398794052498 L 2414.162930146203 4865.484282298505 L 2434.2986097514026 4875.569770544512" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1191.0174020466916" y="4905.065736448505" width="174.78810174308595" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1194.9755474616916" y="4928.814608938505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"Mot de passe trop faible"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 4939.369663378505 L 148.43045306250002 4939.369663378505" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(145.13199855000002,4939.369663378505) translate(-145.13199855000002,-4939.369663378505)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 167.73970101493347 4929.284175132498 L 147.6040214097338 4939.369663378505 L 167.73970101493347 4949.455151624512" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3839.906390820291" y="5050.197734998505" width="240.87965447746095" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3843.8645362352913" y="5073.946607488506" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">createHash('sha256').update(token)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 5084.501661928505 L 4560.049708907746 5084.501661928505" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4563.348163420246,5084.501661928505) translate(-4563.348163420246,-5084.501661928505)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4540.740460955313 5074.416173682498 L 4560.876140560513 5084.501661928505 L 4540.740460955313 5094.587150174512" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3912.780353222635" y="5124.083116078506" width="95.13172967277343" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3916.738498637635" y="5147.831988568506" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">hashedToken</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4563.348163420246 5158.387043008505 L 3360.6427272102974 5158.387043008505" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,5158.387043008505) translate(-3357.3442726977974,-5158.387043008505)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 5148.301554762498 L 3359.8162955575312 5158.387043008505 L 3379.951975162731 5168.472531254512" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3939.3327418232147" y="5197.968497158506" width="166.00502068839845" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3943.290887238215" y="5221.717369648506" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET reset:hashedToken</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 5232.272424088505 L 4684.027777124531 5232.272424088505" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4687.326231637031,5232.272424088505) translate(-4687.326231637031,-5232.272424088505)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4664.718529172098 5222.186935842498 L 4684.854208777298 5232.272424088505 L 4664.718529172098 5242.357912334513" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4006.966950502414" y="5343.100495708506" width="30.73660333" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4010.925095917414" y="5366.849368198506" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">null</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4687.326231637031 5377.404422638506 L 3360.6427272102974 5377.404422638506" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,5377.404422638506) translate(-3357.3442726977974,-5377.404422638506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 5367.318934392499 L 3359.8162955575312 5377.404422638506 L 3379.951975162731 5387.489910884513" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3140.171202265512" y="5416.985876788506" width="121.9892431005078" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3144.129347680512" y="5440.734749278507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">InvalidTokenError</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 5451.289803718506 L 3048.285829446235 5451.289803718506" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3044.987374933735,5451.289803718506) translate(-3044.987374933735,-5451.289803718506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3067.5950773986683 5441.204315472499 L 3047.4593977934687 5451.289803718506 L 3067.5950773986683 5461.375291964513" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2667.7346257610197" y="5490.871257868506" width="121.20903069816406" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2671.69277117602" y="5514.620130358507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">400 Bad Request</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 5525.175184798506 L 2414.989361798969 5525.175184798506" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(2411.690907286469,5525.175184798506) translate(-2411.690907286469,-5525.175184798506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 5515.089696552499 L 2414.162930146203 5525.175184798506 L 2434.2986097514026 5535.260673044513" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3998.004891481418" y="5636.003256418507" width="48.66072137199219" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4001.963036896418" y="5659.752128908507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">userId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4687.326231637031 5670.307183348506 L 3360.6427272102974 5670.307183348506" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,5670.307183348506) translate(-3357.3442726977974,-5670.307183348506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 5660.221695102499 L 3359.8162955575312 5670.307183348506 L 3379.951975162731 5680.392671594514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3388.569642082797" y="5709.888637498506" width="209.17604119621095" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3392.5277874977974" y="5733.637509988506" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">bcrypt.hash(newPassword, 10)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 5744.192564428507 L 3462.8948170977974 5744.192564428507 L 3462.8948170977974 5778.496491358506 L 3360.6427272102974 5778.496491358506" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3357.3442726977974,5778.496491358506) translate(-3357.3442726977974,-5778.496491358506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 5768.411003112499 L 3359.8162955575312 5778.496491358506 L 3379.951975162731 5788.581979604513" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3388.569642082797" y="5818.077945508506" width="120.37866265617187" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3392.5277874977974" y="5841.826817998506" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">hashedPassword</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 5852.381872438506 L 3462.8948170977974 5852.381872438506 L 3462.8948170977974 5886.685799368506 L 3360.6427272102974 5886.685799368506" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,5886.685799368506) translate(-3357.3442726977974,-5886.685799368506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 5876.600311122499 L 3359.8162955575312 5886.685799368506 L 3379.951975162731 5896.771287614513" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3540.9675989309417" y="5926.267253518507" width="165.96917779289063" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3544.925744345942" y="5950.016126008507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">prisma.$transaction([...])</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 5960.571180448506 L 3887.261648444477 5960.571180448506" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(3890.560102956977,5960.571180448506) translate(-3890.560102956977,-5960.571180448506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3867.9524004920436 5950.485692202499 L 3888.088080097243 5960.571180448506 L 3867.9524004920436 5970.656668694513" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3921.785472341977" y="6000.152634598507" width="494.9168096288281" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3925.743617756977" y="6023.901507088507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">UPDATE customers SET password = ?, reset_token_requested_at = NULL</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 6034.456561528506 L 4444.629257878461 6034.456561528506" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4447.9277123909615,6034.456561528506) translate(-4447.9277123909615,-6034.456561528506)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4425.320009926028 6024.371073282499 L 4445.455689531228 6034.456561528506 L 4425.320009926028 6044.5420497745135" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3970.8226808991058" y="6074.038015678507" width="396.8424688085156" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3974.780826314106" y="6097.786888168507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">INSERT INTO password_history (customer_id, changed_at)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3890.560102956977 6108.3419426085065 L 4444.629257878461 6108.3419426085065" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4447.9277123909615,6108.3419426085065) translate(-4447.9277123909615,-6108.3419426085065)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4425.320009926028 6098.256454362499 L 4445.455689531228 6108.3419426085065 L 4425.320009926028 6118.427430854514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3940.141625490207" y="6147.923396758507" width="164.38725335441407" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3944.099770905207" y="6171.672269248507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DEL reset:hashedToken</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 6182.227323688507 L 4684.027777124531 6182.227323688507" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4687.326231637031,6182.227323688507) translate(-4687.326231637031,-6182.227323688507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4664.718529172098 6172.1418354424995 L 4684.854208777298 6182.227323688507 L 4664.718529172098 6192.312811934514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4007.7865534687226" y="6221.808777838507" width="29.097397397382814" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4011.744698883723" y="6245.557650328507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4687.326231637031 6256.112704768507 L 3360.6427272102974 6256.112704768507" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,6256.112704768507) translate(-3357.3442726977974,-6256.112704768507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 6246.0272165225 L 3359.8162955575312 6256.112704768507 L 3379.951975162731 6266.198193014514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3949.1743493263825" y="6295.694158918507" width="291.48095757804685" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3953.1324947413827" y="6319.4430314085075" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sendPasswordChangedConfirmation(email)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 6329.998085848507 L 4829.186929020515 6329.998085848507" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(4832.485383533015,6329.998085848507) translate(-4832.485383533015,-6329.998085848507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4809.877681068082 6319.9125976025 L 4830.013360673282 6329.998085848507 L 4809.877681068082 6340.083574094514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="4056.736940879117" y="6369.579539998507" width="76.35577447257812" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="4060.695086294117" y="6393.328412488508" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Email sent</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 4832.485383533015 6403.883466928507 L 3360.6427272102974 6403.883466928507" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3357.3442726977974,6403.883466928507) translate(-3357.3442726977974,-6403.883466928507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3379.951975162731 6393.7979786825 L 3359.8162955575312 6403.883466928507 L 3379.951975162731 6413.968955174514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="3110.4360719554534" y="6443.464921078507" width="181.459503720625" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="3114.3942173704536" y="6467.213793568508" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Password reset successful</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3357.3442726977974 6477.768848008507 L 3048.285829446235 6477.768848008507" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(3044.987374933735,6477.768848008507) translate(-3044.987374933735,-6477.768848008507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3067.5950773986683 6467.6833597625 L 3047.4593977934687 6477.768848008507 L 3067.5950773986683 6487.854336254514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2699.5241612834807" y="6517.3503021585075" width="57.62995965324219" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2703.482306698481" y="6541.099174648508" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 OK</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 3044.987374933735 6551.654229088507 L 2414.989361798969 6551.654229088507" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(2411.690907286469,6551.654229088507) translate(-2411.690907286469,-6551.654229088507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 6541.5687408425 L 2414.162930146203 6551.654229088507 L 2434.2986097514026 6561.739717334514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="1157.209258430969" y="6591.235683238508" width="242.40438897453126" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1161.167403845969" y="6614.984555728508" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"Mot de passe modifié avec succès"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 6625.539610168507 L 148.43045306250002 6625.539610168507" stroke-miterlimit="10" stroke-width="2.1989696750000003" stroke-dasharray="10.555054440000001"/><g transform="translate(145.13199855000002,6625.539610168507) translate(-145.13199855000002,-6625.539610168507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 167.73970101493347 6615.4541219225 L 147.6040214097338 6625.539610168507 L 167.73970101493347 6635.6250984145145" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><rect fill="white" stroke="none" x="2442.916276671469" y="6665.121064318507" width="117.92340142570312" height="34.30392693"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="2446.874422086469" y="6688.869936808507" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Redirect to /login</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2411.690907286469 6699.4249912485075 L 2517.241451686469 6699.4249912485075 L 2517.241451686469 6733.728918178507 L 2414.989361798969 6733.728918178507" stroke-miterlimit="10" stroke-width="2.1989696750000003"/><g transform="translate(2411.690907286469,6733.728918178507) translate(-2411.690907286469,-6733.728918178507)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 2434.2986097514026 6723.6434299325 L 2414.162930146203 6733.728918178507 L 2434.2986097514026 6743.814406424514" stroke-miterlimit="10" stroke-width="2.1989696750000003"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 820.2596681685001 L 5053.611388868367 820.2596681685001 L 5053.611388868367 2548.649832718502 L 52.77527220000002 2548.649832718502 L 52.77527220000002 820.2596681685001 Z" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 820.2596681685001 L 52.77527220000002 851.9248314885001 L 119.23934139707033 851.9248314885001 L 135.07192305707034 836.0922498285 L 135.07192305707034 820.2596681685001 L 52.77527220000002 820.2596681685001" stroke-miterlimit="10" stroke-width="3.7696623000000002"/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="79.16290830000003" y="841.3697770485" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="157.50141374207035" y="822.3706790565001" width="110.8858495458203" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="161.45955915707034" y="841.3697770485" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Email non trouvé]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 1260.9331910385006 L 5053.611388868367 1260.9331910385006" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray="6.596909025"/></g><g/><g><rect fill="white" stroke="none" x="157.50141374207035" y="1263.0442019265004" width="86.1314550145703" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="161.45955915707034" y="1282.0432999185005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Email trouvé]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 3213.6182624385024 L 4779.682957987032 3213.6182624385024 L 4779.682957987032 4242.736070338504 L 52.77527220000002 4242.736070338504 L 52.77527220000002 3213.6182624385024 Z" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 3213.6182624385024 L 52.77527220000002 3245.2834257585023 L 119.23934139707033 3245.2834257585023 L 135.07192305707034 3229.4508440985023 L 135.07192305707034 3213.6182624385024 L 52.77527220000002 3213.6182624385024" stroke-miterlimit="10" stroke-width="3.7696623000000002"/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="79.16290830000003" y="3234.7283713185025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="157.50141374207035" y="3215.7292733265026" width="151.74607903800782" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="161.45955915707034" y="3234.7283713185025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Token invalide ou expiré]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 3580.4064042285027 L 4779.682957987031 3580.4064042285027" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray="6.596909025"/></g><g/><g><rect fill="white" stroke="none" x="157.50141374207035" y="3582.517415116503" width="85.91383416496093" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="161.45955915707034" y="3601.5165131085027" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Token valide]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 26.38763610000001 4686.0483568185045 L 4951.229745983015 4686.0483568185045 L 4951.229745983015 6812.891826478508 L 26.38763610000001 6812.891826478508 L 26.38763610000001 4686.0483568185045 Z" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 26.38763610000001 4686.0483568185045 L 26.38763610000001 4717.7135201385045 L 92.85170529707032 4717.7135201385045 L 108.68428695707033 4701.8809384785045 L 108.68428695707033 4686.0483568185045 L 26.38763610000001 4686.0483568185045" stroke-miterlimit="10" stroke-width="3.7696623000000002"/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="52.77527220000001" y="4707.158465698504" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="131.11377764207035" y="4688.159367706504" width="123.93319756828124" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="135.07192305707034" y="4707.158465698504" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Mot de passe faible]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 26.38763610000001 4978.951117528505 L 4951.229745983015 4978.951117528505" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray="6.596909025"/></g><g/><g><rect fill="white" stroke="none" x="131.11377764207035" y="4981.0621284165045" width="110.89161736808593" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="135.07192305707034" y="5000.061226408505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Mot de passe OK]</text></g><g/><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 5271.853878238506 L 4924.842109883015 5271.853878238506 L 4924.842109883015 6773.310372328508 L 52.77527220000002 6773.310372328508 L 52.77527220000002 5271.853878238506 Z" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 5271.853878238506 L 52.77527220000002 5303.519041558506 L 119.23934139707033 5303.519041558506 L 135.07192305707034 5287.686459898506 L 135.07192305707034 5271.853878238506 L 52.77527220000002 5271.853878238506" stroke-miterlimit="10" stroke-width="3.7696623000000002"/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="79.16290830000003" y="5292.963987118505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">alt</text><g><rect fill="white" stroke="none" x="157.50141374207035" y="5273.964889126505" width="96.33793694816406" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="161.45955915707034" y="5292.963987118505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Token invalide]</text><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 52.77527220000002 5564.756638948506 L 4924.842109883015 5564.756638948506" stroke-miterlimit="10" stroke-width="3.7696623000000002" stroke-dasharray="6.596909025"/></g><g/><g><rect fill="white" stroke="none" x="157.50141374207035" y="5566.867649836506" width="85.91383416496093" height="27.443141544000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="161.45955915707034" y="5585.866747828506" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[Token valide]</text></g><g/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></g></svg>